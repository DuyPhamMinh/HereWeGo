<!DOCTYPE html>
<html lang="en">

    <head>
        <%- include('partical/head'); %>
    </head>

    <body>

        <!-- Spinner Start -->
        <div id="spinner" class="show bg-white position-fixed translate-middle w-100 vh-100 top-50 start-50 d-flex align-items-center justify-content-center">
            <div class="spinner-border text-primary" style="width: 3rem; height: 3rem;" role="status">
                <span class="sr-only">Loading...</span>
            </div>
        </div>
        <!-- Spinner End -->

        <% var activePage = 'packages'; %>
        <%- include('partical/menu'); %>

        <!-- Header Start -->
        <div class="container-fluid bg-breadcrumb">
            <div class="container text-center py-5" style="max-width: 900px;">
                <h3 class="text-white display-3 mb-4">Travel Packages</h1>
                <ol class="breadcrumb justify-content-center mb-0">
                    <li class="breadcrumb-item"><a href="/">Home</a></li>
                    <li class="breadcrumb-item"><a href="#">Pages</a></li>
                    <li class="breadcrumb-item active text-white">Packages</li>
                </ol>    
            </div>
        </div>
        <!-- Header End -->

        <!-- Packages Start -->
        <div class="container-fluid packages py-5">
            <div class="container py-5">
                <div class="mx-auto text-center mb-5" style="max-width: 900px;">
                    <h5 class="section-title px-3">Packages</h5>
                    <h1 class="mb-0">Awesome Packages</h1>
                </div>

                <!-- Search and Filter -->
                <div class="row mb-4">
                    <div class="col-md-8">
                        <form method="GET" action="/packages" class="d-flex">
                            <input type="text" class="form-control me-2" name="search" placeholder="Search tours..." value="<%= typeof search !== 'undefined' ? search : '' %>">
                            <button type="submit" class="btn btn-primary">
                                <i class="fa fa-search me-2"></i>Search
                            </button>
                        </form>
                    </div>
                    <div class="col-md-4">
                        <form method="GET" action="/packages" class="d-flex">
                            <input type="hidden" name="search" value="<%= typeof search !== 'undefined' ? search : '' %>">
                            <select class="form-select" name="category" onchange="this.form.submit()">
                                <option value="">All Categories</option>
                                <% if (typeof categories !== 'undefined' && categories.length > 0) { %>
                                    <% categories.forEach(function(cat) { %>
                                    <option value="<%= cat %>" <%= typeof category !== 'undefined' && category === cat ? 'selected' : '' %>><%= cat.charAt(0).toUpperCase() + cat.slice(1) %></option>
                                    <% }); %>
                                <% } %>
                            </select>
                        </form>
                    </div>
                </div>

                <!-- Tours Grid -->
                <% if (typeof tours !== 'undefined' && tours.length > 0) { %>
                <div class="row g-4">
                    <% tours.forEach(function(tour) { %>
                    <div class="col-lg-4 col-md-6">
                        <div class="packages-item">
                            <div class="packages-img">
                                <img src="<%= tour.image || '/static/img/packages-1.jpg' %>" class="img-fluid w-100 rounded-top" alt="<%= tour.title %>">
                                <div class="packages-info d-flex border border-start-0 border-end-0 position-absolute" style="width: 100%; bottom: 0; left: 0; z-index: 5;">
                                    <small class="flex-fill text-center border-end py-2 text-truncate" style="min-width:0;" title="<%= tour.destination %>"><i class="fa fa-map-marker-alt me-2"></i><%= tour.destination && tour.destination.length > 15 ? tour.destination.substring(0, 15) + '...' : tour.destination %></small>
                                    <small class="flex-fill text-center border-end py-2 text-truncate" style="min-width:0;"><i class="fa fa-calendar-alt me-2"></i><%= tour.duration > 999 ? '999+' : tour.duration %> <%= tour.durationUnit || 'days' %></small>
                                    <small class="flex-fill text-center py-2 text-truncate" style="min-width:0;"><i class="fa fa-user me-2"></i><%= (tour.maxPersons || 2) > 99 ? '99+' : (tour.maxPersons || 2) %> Person</small>
                                </div>
                                <div class="packages-price py-2 px-4">
                                    <% if (tour.discountPrice) { %>
                                    <span class="text-decoration-line-through text-white-50" style="font-size: 0.8em;">$<%= tour.price.toFixed(2) %></span><br>
                                    $<%= tour.discountPrice.toFixed(2) %>
                                    <% } else { %>
                                    $<%= tour.price.toFixed(2) %>
                                    <% } %>
                                </div>
                            </div>
                            <div class="packages-content bg-light">
                                <div class="p-4 pb-0">
                                    <h5 class="mb-0"><%= tour.title %></h5>
                                    <small class="text-uppercase"><%= tour.category || 'Tour' %></small>
                                    <div class="mb-3">
                                        <% for (let i = 0; i < Math.floor(tour.rating || 5); i++) { %>
                                        <small class="fa fa-star text-primary"></small>
                                        <% } %>
                                        <% for (let i = Math.floor(tour.rating || 5); i < 5; i++) { %>
                                        <small class="fa fa-star"></small>
                                        <% } %>
                                    </div>
                                    <p class="mb-4"><%= tour.shortDescription || (tour.description ? (tour.description.length > 100 ? tour.description.substring(0, 100) + '...' : tour.description) : '') %></p>
                                </div>
                                <div class="row bg-primary rounded-bottom mx-0">
                                    <div class="col-6 text-start px-0">
                                        <a href="/packages?tour=<%= tour._id %>" class="btn-hover btn text-white py-2 px-4">Read More</a>
                                    </div>
                                    <div class="col-6 text-end px-0">
                                        <a href="/booking?tour=<%= tour._id %>" class="btn-hover btn text-white py-2 px-4">Book Now</a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <% }); %>
                </div>

                <!-- Pagination -->
                <% if (typeof totalPages !== 'undefined' && totalPages > 1) { %>
                <nav aria-label="Page navigation" class="mt-5">
                    <ul class="pagination justify-content-center">
                        <% if (typeof currentPage !== 'undefined' && currentPage > 1) { %>
                        <li class="page-item">
                            <a class="page-link" href="?page=<%= currentPage - 1 %><%= typeof search !== 'undefined' && search ? '&search=' + search : '' %><%= typeof category !== 'undefined' && category ? '&category=' + category : '' %>">Previous</a>
                        </li>
                        <% } %>

                        <% for (let i = 1; i <= totalPages; i++) { %>
                        <% if (i === 1 || i === totalPages || (i >= currentPage - 2 && i <= currentPage + 2)) { %>
                        <li class="page-item <%= i === currentPage ? 'active' : '' %>">
                            <a class="page-link" href="?page=<%= i %><%= typeof search !== 'undefined' && search ? '&search=' + search : '' %><%= typeof category !== 'undefined' && category ? '&category=' + category : '' %>"><%= i %></a>
                        </li>
                        <% } else if (i === currentPage - 3 || i === currentPage + 3) { %>
                        <li class="page-item disabled">
                            <span class="page-link">...</span>
                        </li>
                        <% } %>
                        <% } %>

                        <% if (typeof currentPage !== 'undefined' && currentPage < totalPages) { %>
                        <li class="page-item">
                            <a class="page-link" href="?page=<%= currentPage + 1 %><%= typeof search !== 'undefined' && search ? '&search=' + search : '' %><%= typeof category !== 'undefined' && category ? '&category=' + category : '' %>">Next</a>
                        </li>
                        <% } %>
                    </ul>
                </nav>
                <% } %>
                <% } else { %>
                <div class="alert alert-info text-center">
                    <i class="fa fa-info-circle me-2"></i>No tours found. Please try different search criteria.
                </div>
                <% } %>
            </div>
        </div>
        <!-- Packages End -->

        <!-- Tour Booking Start -->
        <div class="container-fluid booking py-5">
            <div class="container py-5">
                <div class="row g-5 align-items-center">
                    <div class="col-lg-6">
                        <h5 class="section-booking-title pe-3">Booking</h5>
                        <h1 class="text-white mb-4">Online Booking</h1>
                        <p class="text-white mb-4">Lorem ipsum dolor sit amet consectetur adipisicing elit. Aspernatur maxime ullam esse fuga blanditiis accusantium pariatur quis sapiente, veniam doloribus praesentium? Repudiandae iste voluptatem fugiat doloribus quasi quo iure officia.
                        </p>
                        <p class="text-white mb-4">Lorem ipsum dolor sit amet consectetur adipisicing elit. Aspernatur maxime ullam esse fuga blanditiis accusantium pariatur quis sapiente, veniam doloribus praesentium? Repudiandae iste voluptatem fugiat doloribus quasi quo iure officia.
                        </p>
                        <a href="#" class="btn btn-light text-primary rounded-pill py-3 px-5 mt-2">Read More</a>
                    </div>
                    <div class="col-lg-6">
                        <h1 class="text-white mb-3">Book A Tour Deals</h1>
                        <p class="text-white mb-4">Get <span class="text-warning">50% Off</span> On Your First Adventure Trip With HereWeGo. Get More Deal Offers Here.</p>
                        <form>
                            <div class="row g-3">
                                <div class="col-md-6">
                                    <div class="form-floating">
                                        <input type="text" class="form-control bg-white border-0" id="name" placeholder="Your Name">
                                        <label for="name">Your Name</label>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="form-floating">
                                        <input type="email" class="form-control bg-white border-0" id="email" placeholder="Your Email">
                                        <label for="email">Your Email</label>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="form-floating date" id="date3" data-target-input="nearest">
                                        <input type="text" class="form-control bg-white border-0" id="datetime" placeholder="Date & Time" data-target="#date3" data-toggle="datetimepicker" />
                                        <label for="datetime">Date & Time</label>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="form-floating">
                                        <select class="form-select bg-white border-0" id="destinationSelectPackages">
                                            <option value="1">Destination 1</option>
                                            <option value="2">Destination 2</option>
                                            <option value="3">Destination 3</option>
                                        </select>
                                        <label for="destinationSelectPackages">Destination</label>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="form-floating">
                                        <select class="form-select bg-white border-0" id="SelectPerson">
                                            <option value="1">Persons 1</option>
                                            <option value="2">Persons 2</option>
                                            <option value="3">Persons 3</option>
                                        </select>
                                        <label for="SelectPerson">Persons</label>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="form-floating">
                                        <select class="form-select bg-white border-0" id="CategoriesSelect">
                                            <option value="1">Kids</option>
                                            <option value="2">1</option>
                                            <option value="3">2</option>
                                            <option value="3">3</option>
                                        </select>
                                        <label for="CategoriesSelect">Categories</label>
                                    </div>
                                </div>
                                <div class="col-12">
                                    <div class="form-floating">
                                        <textarea class="form-control bg-white border-0" placeholder="Special Request" id="message" style="height: 100px"></textarea>
                                        <label for="message">Special Request</label>
                                    </div>
                                </div>
                                <div class="col-12">
                                    <button class="btn btn-primary text-white w-100 py-3" type="submit">Book Now</button>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
        <!-- Tour Booking End -->
        
        <!-- Subscribe Start -->
        <div class="container-fluid subscribe py-5">
            <div class="container text-center py-5">
                <div class="mx-auto text-center" style="max-width: 900px;">
                    <h5 class="subscribe-title px-3">Subscribe</h5>
                    <h1 class="text-white mb-4">Our Newsletter</h1>
                    <p class="text-white mb-5">Lorem ipsum dolor sit amet consectetur adipisicing elit. Laborum tempore nam, architecto doloremque velit explicabo? Voluptate sunt eveniet fuga eligendi! Expedita laudantium fugiat corrupti eum cum repellat a laborum quasi.
                    </p>
                    <div class="position-relative mx-auto">
                        <input class="form-control border-primary rounded-pill w-100 py-3 ps-4 pe-5" type="text" placeholder="Your email">
                        <button type="button" class="btn btn-primary rounded-pill position-absolute top-0 end-0 py-2 px-4 mt-2 me-2">Subscribe</button>
                    </div>
                </div>
            </div>
        </div>
        <!-- Subscribe End -->

        <%- include('partical/footer'); %>
    </body>

</html>